<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <!-- Emp√™che le zoom accidentel pendant le jeu (Important pour le tactile rapide) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- Meta Tags pour le partage (Messenger, WhatsApp, SMS) -->
    <meta property="og:title" content="üéÑ Le L√ºzien Secret üéÅ">
    <meta property="og:description" content="D√©couvre ta mission secr√®te pour le party de No√´l !">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#0f172a">

    <!-- Favicon (Le petit P√®re No√´l dans l'onglet) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéÖ</text></svg>">

    <title>üéÑ Le L√ºzien Secret üéÅ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&family=Poppins:wght@400;600&display=swap');
        
        body {
            background-color: #0f172a;
            color: white;
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            touch-action: manipulation; /* D√©sactive le d√©lai de clic sur mobile */
            user-select: none; /* Emp√™che de s√©lectionner le texte en jouant */
            -webkit-user-select: none;
        }

        .title-font {
            font-family: 'Mountains of Christmas', cursive;
        }

        /* Neige en arri√®re-plan */
        .snowflake {
            position: fixed;
            top: -10px;
            color: #fff;
            font-size: 1em;
            text-shadow: 0 0 5px #000;
            animation: fall linear infinite;
            z-index: 1;
            pointer-events: none;
        }

        /* Objets du jeu */
        .falling-item {
            position: fixed;
            top: -80px;
            font-size: 4rem;
            cursor: pointer;
            z-index: 50;
            transition: transform 0.05s;
            touch-action: none; 
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
            -webkit-tap-highlight-color: transparent;
        }
        
        .falling-item:active {
            transform: scale(0.9);
        }

        @keyframes fall {
            to { transform: translateY(110vh); }
        }

        /* UI et Cartes */
        .glass-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .input-code {
            letter-spacing: 0.5em;
            text-align: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .input-code:focus {
            outline: none;
            border-color: #ef4444;
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.5);
        }

        .reveal-anim {
            animation: popIn 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.5) translateY(20px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        /* Effets visuels de clic */
        @keyframes goodPoof {
            0% { transform: scale(1) translateY(0); opacity: 1; filter: brightness(1.5); }
            100% { transform: scale(2) translateY(-20px); opacity: 0; }
        }
        @keyframes badPoof {
            0% { transform: scale(1) rotate(0deg); opacity: 1; color: gray; }
            20% { transform: scale(1.2) rotate(-10deg); color: red; }
            40% { transform: scale(1.2) rotate(10deg); color: red; }
            100% { transform: scale(0) rotate(0deg); opacity: 0; }
        }
        
        .poof-good { animation: goodPoof 0.4s ease-out forwards; pointer-events: none; }
        .poof-bad { animation: badPoof 0.6s ease-out forwards; pointer-events: none; }

        .score-pop {
            position: fixed;
            font-weight: bold;
            font-size: 2rem;
            pointer-events: none;
            z-index: 60;
            animation: floatUp 0.8s forwards;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            50% { transform: translateY(-30px) scale(1.2); }
            100% { opacity: 0; transform: translateY(-60px) scale(1); }
        }

        /* Screen shake for bad hit */
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center relative bg-slate-900">

    <!-- Snow Container -->
    <div id="snow-container"></div>

    <!-- Interface du JEU (Score) -->
    <div id="game-ui" class="hidden fixed top-0 left-0 w-full h-full pointer-events-none z-40 flex flex-col justify-between p-6">
        <div class="flex justify-between items-start">
            <div class="text-4xl font-black text-yellow-400 drop-shadow-[0_4px_4px_rgba(0,0,0,0.8)]">
                <span id="score">0</span> <span class="text-lg text-gray-300">pts</span>
            </div>
            
            <!-- TIMER DISPLAY -->
            <div class="text-4xl font-black text-white drop-shadow-[0_4px_4px_rgba(0,0,0,0.8)] flex flex-col items-center">
                <div><span id="timer">15</span><span class="text-lg">s</span></div>
            </div>

            <div class="text-right bg-black/40 p-2 rounded-lg backdrop-blur-sm border border-white/10">
                <div class="text-xl font-bold">ü•õ = <span class="text-red-500">-3</span></div>
            </div>
        </div>
        
        <!-- Jauge de TEMPS -->
        <div class="w-full bg-gray-700/50 h-6 rounded-full overflow-hidden backdrop-blur border border-white/10 mt-2">
            <div id="time-bar" class="h-full bg-gradient-to-r from-blue-400 to-blue-600 transition-all duration-1000 linear" style="width: 100%"></div>
        </div>
    </div>

    <div class="container mx-auto px-4 z-10 relative max-w-md w-full">
        
        <!-- Carte Principale -->
        <div id="main-card" class="glass-panel rounded-2xl p-8 text-center border-t-4 border-red-600 relative overflow-hidden transition-all duration-500">
            <!-- Ruban D√©coratif -->
            <div class="absolute -top-12 -right-12 bg-red-600 w-24 h-24 rotate-45 transform shadow-lg"></div>

            <!-- √âCRAN 1 : CONNEXION -->
            <div id="login-screen">
                <div class="mb-2 text-6xl animate-bounce">üéÖ</div>
                <h1 class="text-4xl title-font mb-6 text-red-400">Le L√ºzien Secret</h1>

                <!-- SAVE THE DATE WIDGET (Final) -->
                <div class="bg-indigo-900/60 rounded-xl p-4 mb-8 border border-indigo-500/50 shadow-lg relative overflow-hidden group">
                    <div class="absolute top-0 right-0 w-16 h-16 bg-white/5 rounded-bl-full -mr-8 -mt-8"></div>
                    
                    <h3 class="text-yellow-400 font-bold text-lg title-font mb-1 flex items-center justify-center gap-2">
                        <span>üìÖ</span> Save the Date !
                    </h3>
                    <p class="text-white font-bold text-lg mb-1">18 D√©cembre <span class="text-sm font-normal text-indigo-300">|</span> 17h00</p>
                    
                    <p class="text-gray-200 text-sm leading-relaxed mb-3">
                        Le party commence... <br>
                        <span class="text-indigo-300 italic">en dehors du bureau ce coup-ci ! ü•Ç</span>
                    </p>
                    
                    <div class="bg-indigo-950/60 rounded p-2 text-xs text-indigo-100 border-l-2 border-yellow-500 text-left">
                        ‚ö†Ô∏è Nous ferons l'√âchange plus tard dans la soir√©e, n'oubliez pas d'amener votre cadeau avec vous.
                    </div>
                </div>

                <p class="text-gray-400 mb-2 text-xs uppercase tracking-widest">Zone Membres</p>

                <input type="tel" id="pin-input" maxlength="4" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                       class="w-full bg-slate-800 border-2 border-slate-600 text-white rounded-xl py-4 mb-4 input-code placeholder-gray-600 focus:bg-slate-700">
                
                <p id="error-msg" class="text-red-400 text-sm font-bold mb-4 opacity-0 transition-opacity">Code incorrect üö´</p>

                <button onclick="checkCode()" 
                        class="w-full bg-gradient-to-r from-red-600 to-red-800 hover:from-red-500 hover:to-red-700 text-white font-bold py-4 rounded-xl shadow-lg transform transition active:scale-95 uppercase tracking-wider">
                    Ouvrir
                </button>
            </div>

            <!-- √âCRAN 2 : INTRO JEU -->
            <div id="game-intro-screen" class="hidden">
                <div class="mb-4 text-6xl animate-pulse">‚è±Ô∏è</div>
                <h2 class="text-2xl title-font text-white mb-2">VITE il est 4pm !</h2>
                
                <p class="text-yellow-400 font-bold text-lg mb-4">Allo <span id="player-name">Toi</span> !</p>

                <div class="text-gray-300 mb-6 space-y-4 text-sm bg-black/20 p-4 rounded-lg text-left">
                    <div class="flex items-center gap-3">
                        <span class="text-3xl">üç∫</span>
                        <div>
                            <strong class="text-green-400 uppercase text-xs block">Objectif</strong>
                            <span>Ramasse le plus de <strong>bi√®re</strong> possible !</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 border-t border-white/10 pt-3">
                        <span class="text-3xl">‚è≥</span>
                        <div>
                            <strong class="text-blue-400 uppercase text-xs block">Temps</strong>
                            <span>Tu as seulement <strong>15 secondes</strong>.</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 border-t border-white/10 pt-3">
                        <span class="text-3xl">ü•õ</span>
                        <div>
                            <strong class="text-red-400 uppercase text-xs block">Danger</strong>
                            <span class="text-gray-300 text-xs">√âvite les <strong>verres de lait</strong> !<br>(C'est pour le P√®re No√´l) <span class="text-red-400 font-bold">-3 pts</span></span>
                        </div>
                    </div>
                </div>
                <button onclick="startGame()" 
                        class="w-full bg-gradient-to-r from-green-600 to-green-800 hover:from-green-500 hover:to-green-700 text-white font-bold py-4 rounded-xl shadow-lg transform transition active:scale-95 uppercase tracking-wider animate-pulse">
                    GO ! (15s)
                </button>
            </div>

            <!-- √âCRAN 3 : R√âSULTAT FINAL -->
            <div id="result-screen" class="hidden">
                <div class="mb-1 text-6xl animate-bounce">üèÜ</div>
                <h2 class="text-xl title-font text-white mb-0">Temps √©coul√© !</h2>
                
                <!-- SCORE & TITRE QUEB -->
                <div class="mb-4">
                    <p class="text-yellow-400 font-bold text-3xl"><span id="final-score">0</span> pts</p>
                    <p id="quebec-title" class="text-red-300 font-bold text-sm italic mt-1">"Pas pire pantoute!"</p>
                </div>

                <p class="text-gray-300 mb-6 text-sm">Tu dois offrir un cadeau √† :</p>
                
                <div class="bg-gradient-to-br from-red-900/50 to-slate-900/50 rounded-xl p-6 border-2 border-dashed border-red-500/50 mb-6 reveal-anim shadow-inner">
                    <h1 id="target-name" class="text-3xl font-bold text-red-400 break-words drop-shadow-sm">...</h1>
                </div>

                <!-- D√âTAILS DU CADEAU -->
                <div class="bg-slate-800/80 rounded-lg p-4 mb-6 text-sm text-left border border-slate-600 reveal-anim shadow-lg" style="animation-delay: 0.5s;">
                    <h3 class="text-red-400 font-bold mb-3 uppercase text-xs tracking-wider border-b border-slate-600 pb-2 flex justify-between items-center">
                        <span>üìã Mission</span>
                        <span>üéÖ</span>
                    </h3>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <span class="mr-3 text-2xl">üç∫</span> 
                            <div>
                                <span class="block font-bold text-yellow-500 text-xs uppercase">Quoi ?</span>
                                <span class="text-gray-200">Tasse ou Pinte de bi√®re</span>
                                <span class="text-xs text-slate-400 block mt-1">Qui te fait penser √† la personne ou que tu penses qu'elle aimerait √ßa</span>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="mr-3 text-2xl">üí∞</span> 
                            <div>
                                <span class="block font-bold text-green-400 text-xs uppercase">Budget</span>
                                <span class="text-gray-200">15 √† 25 $</span>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="mr-3 text-2xl">üìç</span> 
                            <div>
                                <span class="block font-bold text-blue-400 text-xs uppercase">O√π ?</span>
                                <span class="text-gray-200">Apporte-le √† l'activit√© <strong class="text-white border-b border-blue-400">le 18 D√©cembre</strong> !</span>
                            </div>
                        </li>
                    </ul>
                </div>
                
                <button onclick="restartGame()" class="text-xs text-gray-500 hover:text-white underline py-4">
                    Rejouer pour battre ton score
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- DONN√âES S√âCURIS√âES ---
        const encryptedData = {
            "8192": { self: "91-102-107-99-123-117-114-103-118", target: "76-98-127-107-108-33-89-113-113-115-114-103-122" }, 
            "2841": { self: "79-105-124-106-111-109", target: "70-105-122-102-34-88-101-120-117-109-125" }, 
            "3719": { self: "70-115-234-118-104-117-117", target: "86-112-110-120-113" }, 
            "4562": { self: "87-110-115-113-114", target: "80-102-123-116-105-115-105-103" }, 
            "5931": { self: "73-106-121-106-105-41-83-112-110-123-108-102-119", target: "82-242-111-98-115-114-104" }, 
            "6284": { self: "88-113-108-115-114-114-112-105", target: "83-99-111-101-114-107-109" }, 
            "7153": { self: "74-234-105-117-112-100", target: "90-102-103-100-122-117-110-104-117" }, 
            "8426": { self: "85-101-105-103-116-109-103", target: "85-101-122-111-117-105" }, 
            "9371": { self: "74-113-117-102-54-79-104-118-123-104-117-100-110", target: "76-236-107-115-114-102" }, 
            "1682": { self: "78-103-124-118-105-111-109-119", target: "83-117-108-113-109-118-112-103" }, 
            "2943": { self: "78-106-121-117-103-119-103-104", target: "79-106-120-119-106-114-105-120" }, 
            "3057": { self: "71-97-123-108-35-80-102-126-118-101-126", target: "68-110-115-108-48-76-102-124-117-101-115-106-104" }, 
            "5418": { self: "82-237-109-105-115-109-102", target: "72-112-234-117-106-114-117" } 
        };

        // --- VARIABLES DU JEU ---
        let currentScore = 0;
        const totalTime = 15; // secondes
        let timeLeft = totalTime;
        let gameInterval;
        let timerInterval;
        let spawnRate = 400; 
        let isGameRunning = false;
        const isMobile = window.innerWidth <= 768;

        function decode(pin, cipher) {
            try {
                const parts = cipher.split('-');
                let result = "";
                const pinStr = pin.toString();
                for(let i = 0; i < parts.length; i++) {
                    const shift = parseInt(pinStr[i % pinStr.length]);
                    const charCode = parseInt(parts[i]) - shift;
                    result += String.fromCharCode(charCode);
                }
                return result;
            } catch(e) { return null; }
        }

        // --- √âTAPE 1: V√âRIFICATION ---
        function checkCode() {
            const pin = document.getElementById('pin-input').value;
            const errorMsg = document.getElementById('error-msg');
            
            if (encryptedData[pin]) {
                const userData = encryptedData[pin];
                const targetName = decode(pin, userData.target);
                const playerName = decode(pin, userData.self);
                
                document.getElementById('player-name').innerText = playerName;
                document.getElementById('target-name').innerText = targetName;
                
                document.getElementById('pin-input').blur();
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('game-intro-screen').classList.remove('hidden');
                errorMsg.style.opacity = '0';
                
            } else {
                errorMsg.style.opacity = '1';
                document.getElementById('pin-input').value = '';
                const input = document.getElementById('pin-input');
                input.style.transform = "translateX(10px)";
                setTimeout(() => input.style.transform = "translateX(-10px)", 100);
                setTimeout(() => input.style.transform = "translateX(0)", 200);
            }
        }

        // --- √âTAPE 2: JEU FUN (TIME ATTACK) ---
        function startGame() {
            const mainCard = document.getElementById('main-card');
            mainCard.style.transform = "scale(0.8) translateY(100vh)";
            mainCard.style.opacity = "0";
            
            setTimeout(() => {
                mainCard.classList.add('hidden');
                mainCard.style.transform = ""; 
                mainCard.style.opacity = "1";
            }, 500);

            document.getElementById('game-ui').classList.remove('hidden');
            document.getElementById('game-ui').style.pointerEvents = "none"; 
            
            isGameRunning = true;
            currentScore = 0;
            timeLeft = totalTime;
            
            // Spawn Rate Ralenti: 250 mobile, 400 desktop
            spawnRate = isMobile ? 250 : 400; 

            updateScoreUI();
            
            gameLoop();
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerUI();
                
                if (timeLeft <= 0) {
                    finishGame();
                }
            }, 1000);
        }

        function restartGame() {
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('game-intro-screen').classList.remove('hidden');
        }

        function updateScoreUI() {
            const scoreEl = document.getElementById('score');
            scoreEl.innerText = currentScore;
            
            if (currentScore > 0) {
                scoreEl.style.transform = "scale(1.5)";
                scoreEl.style.color = "#fff";
                setTimeout(() => {
                    scoreEl.style.transform = "scale(1)";
                    scoreEl.style.color = "";
                }, 150);
            }
        }

        function updateTimerUI() {
            const timerEl = document.getElementById('timer');
            const timeBar = document.getElementById('time-bar');
            
            timerEl.innerText = timeLeft;
            
            const percent = (timeLeft / totalTime) * 100;
            timeBar.style.width = `${percent}%`;
            
            if (timeLeft <= 5) {
                timerEl.style.color = "#ef4444"; 
                timeBar.className = "h-full bg-red-500 transition-all duration-1000 linear";
            } else {
                timerEl.style.color = "white";
            }
        }

        function gameLoop() {
            if (!isGameRunning) return;
            
            spawnItem();
            if (isMobile) {
                setTimeout(spawnItem, 100); 
            }
            
            let nextSpawn = spawnRate;
            if (currentScore > 5) nextSpawn = isMobile ? 200 : 350;
            if (currentScore > 10) nextSpawn = isMobile ? 150 : 250;

            setTimeout(gameLoop, nextSpawn);
        }

        function spawnItem() {
            const isBad = Math.random() > 0.65; 
            const item = document.createElement('div');
            
            item.innerHTML = isBad ? 'ü•õ' : 'üç∫';
            item.classList.add('falling-item');
            
            const randomX = Math.random() * (window.innerWidth - 60);
            item.style.left = randomX + 'px';
            
            const duration = Math.random() * 0.8 + 1.2; 
            item.style.transition = `top ${duration}s linear`;
            
            document.body.appendChild(item);

            requestAnimationFrame(() => {
                item.style.top = (window.innerHeight + 100) + 'px';
            });

            const handleTouch = (e) => {
                e.preventDefault();
                e.stopPropagation();
                
                if (!isGameRunning) return;

                const floatText = document.createElement('div');
                floatText.classList.add('score-pop');
                floatText.style.left = (e.clientX || e.touches[0].clientX) + 'px';
                floatText.style.top = (e.clientY || e.touches[0].clientY) + 'px';

                if (isBad) {
                    item.innerHTML = 'ü§Æ'; 
                    item.classList.add('poof-bad');
                    
                    const penalty = 3;
                    if (currentScore > 0) currentScore = Math.max(0, currentScore - penalty);
                    
                    floatText.innerText = "-3";
                    floatText.style.color = "#ef4444"; 
                    
                    document.body.classList.add('shake');
                    setTimeout(() => document.body.classList.remove('shake'), 500);
                    
                } else {
                    item.innerHTML = '‚ú®';
                    item.classList.add('poof-good');
                    currentScore++;
                    
                    floatText.innerText = "+1";
                    floatText.style.color = "#facc15"; 
                }

                document.body.appendChild(floatText);
                setTimeout(() => floatText.remove(), 800);
                
                updateScoreUI();
                setTimeout(() => item.remove(), 200); 
            };

            item.addEventListener('mousedown', handleTouch);
            item.addEventListener('touchstart', handleTouch);

            setTimeout(() => {
                if(item.parentNode) item.remove();
            }, duration * 1000);
        }

        function getQuebecTitle(score) {
            if (score <= 0) return "Ouin... t'as soif?";
            if (score < 5) return "Un p'tit effort l√†!";
            if (score < 10) return "Pas pire pantoute!";
            if (score < 15) return "√áa c'est d'la broue!";
            return "L√âGENDE DU L√úZIEN ‚öúÔ∏è";
        }

        function finishGame() {
            isGameRunning = false;
            clearInterval(timerInterval);
            
            document.querySelectorAll('.falling-item').forEach(i => i.remove());
            document.getElementById('game-ui').classList.add('hidden');
            
            const mainCard = document.getElementById('main-card');
            mainCard.classList.remove('hidden');
            document.getElementById('game-intro-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            
            document.getElementById('final-score').innerText = currentScore;
            
            // Afficher le titre qu√©b√©cois
            document.getElementById('quebec-title').innerText = getQuebecTitle(currentScore);
            
            const snowContainer = document.getElementById('snow-container');
            snowContainer.innerHTML = ''; 
            createSnow(); 
        }

        // --- AMBIANCE ---
        function createSnow() {
            const snowContainer = document.getElementById('snow-container');
            const snowflakes = 20;
            for (let i = 0; i < snowflakes; i++) {
                const flake = document.createElement('div');
                flake.classList.add('snowflake');
                flake.innerHTML = '‚ùÑ';
                flake.style.left = Math.random() * 100 + 'vw';
                flake.style.animationDuration = Math.random() * 5 + 5 + 's';
                flake.style.opacity = Math.random() * 0.4;
                flake.style.fontSize = Math.random() * 10 + 8 + 'px';
                snowContainer.appendChild(flake);
            }
        }

        document.getElementById('pin-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') checkCode();
        });

        createSnow();
    </script>
</body>
</html>